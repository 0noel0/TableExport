(function(a){a.fn.tableExport=function(d){var e=a.extend({},a.fn.tableExport.defaults,d),g=a.fn.tableExport.rowDel,f,b,c;if(e.bootstrap){f=a.fn.tableExport.bootstrap[0]+" ";b=a.fn.tableExport.bootstrap[1]+" ";c=a.fn.tableExport.bootstrap[2]+" "}else{f=a.fn.tableExport.defaultButton+" ";b=c=""}return this.each(function(){var l=a(this),j=e.headings?l.find("tr"):l.find("tr:has(td)"),o=e.fileName==="id"?(l.attr("id")?l.attr("id"):a.fn.tableExport.defaultFileName):e.fileName,m={xlsx:function(t,p){var u=j.map(function(w,x){var v=a(x).find("th, td");return v.map(function(y,z){return a(z).text()})}).get(),s=JSON.stringify({data:u,name:p}),r=a.fn.tableExport.xlsx.buttonContent,q=a.fn.tableExport.xlsx.defaultClass;n(s,r,q)},xls:function(q,r){var p=a.fn.tableExport.xls.separator,v="data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(j.map(function(x,y){var w=a(y).find("th, td");return w.map(function(z,A){return a(A).html()}).get().join(p)}).get().join(q)),u=r+".xls",t=a.fn.tableExport.xls.buttonContent,s=a.fn.tableExport.xls.defaultClass;h(v,u,t,s)},csv:function(q,r){q='"'+q+'"';var p='"'+a.fn.tableExport.csv.separator+'"',v="data:text/csv;charset=utf-8,"+encodeURIComponent('"'+j.map(function(x,y){var w=a(y).find("th, td");return w.map(function(z,A){return a(A).text().replace(/"/g,'""')}).get().join(p)}).get().join(q)+'"'),u=r+".csv",t=a.fn.tableExport.csv.buttonContent,s=a.fn.tableExport.csv.defaultClass;h(v,u,t,s)},txt:function(q,r){var p=a.fn.tableExport.txt.separator,v="data:text/plain;charset=utf-8,"+encodeURIComponent(j.map(function(x,y){var w=a(y).find("th, td");return w.map(function(z,A){return a(A).text()}).get().join(p)}).get().join(q)),u=r+".txt",t=a.fn.tableExport.txt.buttonContent,s=a.fn.tableExport.txt.defaultClass;h(v,u,t,s)}};e.formats.forEach(function(p){m[p](g,o)});function i(p){var q=l.find("caption:not(.head)");q.length?q.append(p):l.prepend('<caption class="'+c+e.position+'">'+p+"</caption>")}function h(t,r,q,p){var s="<a href='"+t+"' download='"+r+"' role='button' class='"+f+b+p+"'>"+q+"</a>";i(s)}function n(r,q,p){var s="<a href='#' data-obj='"+r+"' download='"+r.name+"' role='button' class='"+f+b+p+"'>"+q+"</a>";i(s);k(p)}function k(q){var p="."+q;return a(p).on("click",function(t){if(a(this).data("obj")){t.preventDefault();var r=a(this).data("obj"),s=r.data,u=r.name;export2xlsx(s,u)}})}})};a.fn.tableExport.defaults={headings:true,formats:["xlsx","xls","csv","txt"],fileName:"id",bootstrap:true,position:"bottom"};a.fn.tableExport.xlsx={defaultClass:"xlsx",buttonContent:"Export to xlsx"};a.fn.tableExport.xls={defaultClass:"xls",buttonContent:"Export to xls",separator:"\t"};a.fn.tableExport.csv={defaultClass:"csv",buttonContent:"Export to csv",separator:","};a.fn.tableExport.txt={defaultClass:"txt",buttonContent:"Export to txt",separator:"  "};a.fn.tableExport.defaultFileName="myDownload";a.fn.tableExport.defaultButton="button-default";a.fn.tableExport.bootstrap=["btn","btn-default","btn-toolbar"];a.fn.tableExport.rowDel="\r\n"}(jQuery));function dateNum(b,a){if(a){b+=1462}var c=Date.parse(b);return(c-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000)}function createSheet(g,f){var b={};var c={s:{c:10000000,r:10000000},e:{c:0,r:0}};for(var e=0;e!=g.length;++e){for(var h=0;h!=g[e].length;++h){if(c.s.r>e){c.s.r=e}if(c.s.c>h){c.s.c=h}if(c.e.r<e){c.e.r=e}if(c.e.c<h){c.e.c=h}var a={v:g[e][h]};if(a.v==null){continue}var d=XLSX.utils.encode_cell({c:h,r:e});if(typeof a.v==="number"){a.t="n"}else{if(typeof a.v==="boolean"){a.t="b"}else{if(a.v instanceof Date){a.t="n";a.z=XLSX.SSF._table[14];a.v=dateNum(a.v)}else{a.t="s"}}}b[d]=a}}if(c.s.c<10000000){b["!ref"]=XLSX.utils.encode_range(c)}return b}function Workbook(){if(!(this instanceof Workbook)){return new Workbook()}this.SheetNames=[];this.Sheets={}}function string2ArrayBuffer(d){var b=new ArrayBuffer(d.length);var a=new Uint8Array(b);for(var c=0;c!=d.length;++c){a[c]=d.charCodeAt(c)&255}return b}function export2xlsx(f,b){var e=new Workbook(),a=createSheet(f);e.SheetNames.push(b);e.Sheets[b]=a;var d={bookType:"xlsx",bookSST:false,type:"binary"};var c=XLSX.write(e,d);saveAs(new Blob([string2ArrayBuffer(c)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),b+".xlsx")};