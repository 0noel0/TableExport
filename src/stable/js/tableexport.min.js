/*!
 * TableExport.js v3.2.0 (http://www.clarketravis.com)
 * Copyright 2015 Travis Clarke
 * Licensed under the MIT license
 */
!function(t,e){function n(t){return String(t).replace(/[&<>'\/]/g,function(t){return f.fn.tableExport.entityMap[t]})}function a(t,e){e&&(t+=1462);var n=Date.parse(t);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function o(t,e){for(var n={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=t.length;++r)for(var l=0;l!=t[r].length;++l){o.s.r>r&&(o.s.r=r),o.s.c>l&&(o.s.c=l),o.e.r<r&&(o.e.r=r),o.e.c<l&&(o.e.c=l);var i={v:t[r][l]};if(null!=i.v){var f=XLSX.utils.encode_cell({c:l,r:r});"number"==typeof i.v?i.t="n":"boolean"==typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=XLSX.SSF._table[14],i.v=a(i.v)):i.t="s",n[f]=i}}return o.s.c<1e7&&(n["!ref"]=XLSX.utils.encode_range(o)),n}function r(){return this instanceof r?(this.SheetNames=[],void(this.Sheets={})):new r}function l(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),a=0;a!=t.length;++a)n[a]=255&t.charCodeAt(a);return e}function i(t,e,n,a){if(".xlsx"===a){var i=new r,s=o(t);i.SheetNames.push(n),i.Sheets[n]=s;var x={bookType:"xlsx",bookSST:!1,type:"binary"},p=XLSX.write(i,x);t=l(p)}saveAs(new Blob([t],{type:e+";"+f.fn.tableExport.charset}),n+a)}var f=t.jQuery;f.fn.tableExport=function(t){var e,a,o,r=f.extend({},f.fn.tableExport.defaults,t),l=f.fn.tableExport.rowDel;return r.bootstrap?(e=f.fn.tableExport.bootstrap[0]+" ",a=f.fn.tableExport.bootstrap[1]+" ",o=f.fn.tableExport.bootstrap[2]+" "):(e=f.fn.tableExport.defaultButton+" ",a=o=""),this.each(function(){function t(t){var e=p.find("caption:not(.head)");e.length?e.append(t):p.prepend('<caption class="'+o+r.position+'">'+t+"</caption>")}function s(n,o,r,l){var i="<a href='#' data-obj='"+n+"' download='"+o+"' role='button' class='"+e+a+l+"'>"+r+"</a>";t(i),x(l)}function x(t){var e="."+t;return f(e).on("click",function(t){if(f(this).data("obj")){t.preventDefault();var e=f(this).data("obj"),n=e.data,a=e.fileName,o=e.mimeType,r=e.fileExtension;i(n,o,a,r)}})}var p=f(this),u=r.headings?p.find("tr"):p.find("tr:has(td)"),b="id"===r.fileName?p.attr("id")?p.attr("id"):f.fn.tableExport.defaultFileName:r.fileName,c={xlsx:function(t,e){var a=u.map(function(t,e){var n=f(e).find("th, td");return[n.map(function(t,e){return f(e).text()}).get()]}).get(),o=n(JSON.stringify({data:a,fileName:e,mimeType:f.fn.tableExport.xlsx.mimeType,fileExtension:f.fn.tableExport.xlsx.fileExtension})),r=f.fn.tableExport.xlsx.buttonContent,l=f.fn.tableExport.xlsx.defaultClass;s(o,e,r,l)},xls:function(t,e){var a=f.fn.tableExport.xls.separator,o=u.map(function(t,e){var n=f(e).find("th, td");return n.map(function(t,e){return f(e).text()}).get().join(a)}).get().join(t),r=n(JSON.stringify({data:o,fileName:e,mimeType:f.fn.tableExport.xls.mimeType,fileExtension:f.fn.tableExport.xls.fileExtension})),l=f.fn.tableExport.xls.buttonContent,i=f.fn.tableExport.xls.defaultClass;s(r,e,l,i)},csv:function(t,e){t='"'+t+'"';var a='"'+f.fn.tableExport.csv.separator+'"',o='"'+u.map(function(t,e){var n=f(e).find("th, td");return n.map(function(t,e){return f(e).text().replace(/"/g,'""')}).get().join(a)}).get().join(t)+'"',r=n(JSON.stringify({data:o,fileName:e,mimeType:f.fn.tableExport.csv.mimeType,fileExtension:f.fn.tableExport.csv.fileExtension})),l=f.fn.tableExport.csv.buttonContent,i=f.fn.tableExport.csv.defaultClass;s(r,e,l,i)},txt:function(t,e){var a=f.fn.tableExport.txt.separator,o=u.map(function(t,e){var n=f(e).find("th, td");return n.map(function(t,e){return f(e).text()}).get().join(a)}).get().join(t),r=n(JSON.stringify({data:o,fileName:e,mimeType:f.fn.tableExport.txt.mimeType,fileExtension:f.fn.tableExport.txt.fileExtension})),l=f.fn.tableExport.txt.buttonContent,i=f.fn.tableExport.txt.defaultClass;s(r,e,l,i)}};r.formats.forEach(function(t){c[t](l,b)})})},f.fn.tableExport.defaults={headings:!0,formats:["xls","csv","txt"],fileName:"id",bootstrap:!0,position:"bottom"},f.fn.tableExport.charset="charset=utf-8",f.fn.tableExport.xlsx={defaultClass:"xlsx",buttonContent:"Export to xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileExtension:".xlsx"},f.fn.tableExport.xls={defaultClass:"xls",buttonContent:"Export to xls",separator:"	",mimeType:"application/vnd.ms-excel",fileExtension:".xls"},f.fn.tableExport.csv={defaultClass:"csv",buttonContent:"Export to csv",separator:",",mimeType:"text/csv",fileExtension:".csv"},f.fn.tableExport.txt={defaultClass:"txt",buttonContent:"Export to txt",separator:"  ",mimeType:"text/plain",fileExtension:".txt"},f.fn.tableExport.defaultFileName="myDownload",f.fn.tableExport.defaultButton="button-default",f.fn.tableExport.bootstrap=["btn","btn-default","btn-toolbar"],f.fn.tableExport.rowDel="\r\n",f.fn.tableExport.entityMap={"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47"}}(window);