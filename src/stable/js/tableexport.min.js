/*!
 * TableExport.js v3.2.14 (https://www.travismclarke.com)
 * Copyright 2016 Travis Clarke
 * Licensed under the MIT license
 */
!function(t,e){"function"==typeof define&&define.amd?define(["exports","jquery","file-saver","xlsx"],e):"object"==typeof exports&&"string"!=typeof exports.nodeName?e(exports,require("jquery"),require("file-saver"),require("xlsx")):e(t,t.jQuery,t.saveAs,t.XLSX)}(this,function(t,e,o,n){"use strict";function r(t,e){if(t&&e)for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}function i(t,e,o){for(var n=0;n<t.length;++n)t[n].addEventListener(e,o,!1)}function s(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.cls)}var l=function(t,e,o){var a=this;a.settings=o?e:r({},l.prototype.defaults,e),a.selectors=t;var p,f,c,u=l.prototype.rowDel,y=a.settings.ignoreRows instanceof Array?a.settings.ignoreRows:[a.settings.ignoreRows],x=a.settings.ignoreCols instanceof Array?a.settings.ignoreCols:[a.settings.ignoreCols],m=a.settings.ignoreCSS instanceof Array?a.settings.ignoreCSS.join(", "):a.settings.ignoreCSS;a.settings.emptyCSS instanceof Array?a.settings.emptyCSS.join(", "):a.settings.emptyCSS;a.settings.bootstrap?(p=l.prototype.bootstrap[0]+" ",f=l.prototype.bootstrap[1]+" ",c=l.prototype.bootstrap[2]+" "):(p=l.prototype.defaultButton+" ",f=c=""),a.selectors.each(function(){function t(t){var e=this.querySelectorAll("caption:not(.head)");e.length?e.appendChild(t):r.insertBefore('<caption class="'+c+a.settings.position+'">'+t+"</caption>",r.firstChild)}function e(e,o,n){var r="<button data-fileblob='"+e+"' class='"+p+f+n+"'>"+o+"</button>";t(r)}var r=this;if(o){var i=r.querySelectorAll("caption:not(.head)");i.parentNode.removeChild(i)}var d=[].slice.call(r.querySelectorAll("tbody > tr")),d=a.settings.headings?d.concat([].slice.call(r.querySelectorAll("tbody > tr, thead > tr"))):d,d=a.settings.footers?d.concat([].slice.call(r.querySelectorAll("tbody > tr, tfoot > tr"))):d,g=a.settings.headings?r.querySelectorAll("thead > tr").length:0,b="id"===a.settings.fileName?r.getAttribute("id")?r.getAttribute("id"):l.prototype.defaultFileName:a.settings.fileName,h={xlsx:function(t,o){var n={},r=[].slice.call(d).map(function(t,e){if(!~y.indexOf(e-g)&&!s(t,m)){var o=t.querySelectorAll("th, td");return[[].slice.call(o).map(function(t,o){if(!~x.indexOf(o)&&!s(t,m)){if(s(t,m))return" ";if(t.hasAttribute("colspan")&&(n[e]=n[e]||{},n[e][o+1]=t.getAttribute("colspan")-1),t.hasAttribute("rowspan"))for(var r=1;r<t.getAttribute("rowspan");r++)n[e+r]=n[e+r]||{},n[e+r][o]=1;return n[e]&&n[e][o]?new Array(n[e][o]).concat(t.textContent):t.textContent}})]}}),i=l.prototype.escapeHtml(JSON.stringify({data:r,fileName:o,mimeType:l.prototype.xlsx.mimeType,fileExtension:l.prototype.xlsx.fileExtension})),a=l.prototype.xlsx.buttonContent,p=l.prototype.xlsx.defaultClass;e(i,a,p)},xlsm:function(t,o){var n={},r=[].slice.call(d).map(function(t,e){if(!~y.indexOf(e-g)&&!s(t,m)){var o=t.querySelectorAll("th, td");return[[].slice.call(o).map(function(t,o){if(!~x.indexOf(o)&&!s(t,m)){if(s(t,m))return" ";if(t.hasAttribute("colspan")&&(n[e]=n[e]||{},n[e][o+1]=t.getAttribute("colspan")-1),t.hasAttribute("rowspan"))for(var r=1;r<t.getAttribute("rowspan");r++)n[e+r]=n[e+r]||{},n[e+r][o]=1;return n[e]&&n[e][o]?new Array(n[e][o]).concat(t.textContent):t.textContent}})]}}),i=l.prototype.escapeHtml(JSON.stringify({data:r,fileName:o,mimeType:l.prototype.xls.mimeType,fileExtension:l.prototype.xls.fileExtension})),a=l.prototype.xls.buttonContent,p=l.prototype.xls.defaultClass;e(i,a,p)},xls:function(t,o){var n=l.prototype.xls.separator,r=[].slice.call(d).map(function(t,e){if(!~y.indexOf(e-g)&&!s(t,m)){var o=t.querySelectorAll("th, td");return[].slice.call(o).map(function(t,e){if(!~x.indexOf(e)&&!s(t,m))return s(t,m)?" ":t.textContent}).join(n)}}).join(t),i=l.prototype.escapeHtml(JSON.stringify({data:r,fileName:o,mimeType:l.prototype.xls.mimeType,fileExtension:l.prototype.xls.fileExtension})),a=l.prototype.xls.buttonContent,p=l.prototype.xls.defaultClass;e(i,a,p)},csv:function(t,o){var n=l.prototype.csv.separator,r=[].slice.call(d).map(function(t,e){if(!~y.indexOf(e-g)&&!s(t,m)){var o=t.querySelectorAll("th, td");return[].slice.call(o).map(function(t,e){if(!~x.indexOf(e)&&!s(t,m))return s(t,m)?" ":t.textContent}).join(n)}}).join(t),i=l.prototype.escapeHtml(JSON.stringify({data:r,fileName:o,mimeType:l.prototype.csv.mimeType,fileExtension:l.prototype.csv.fileExtension})),a=l.prototype.csv.buttonContent,p=l.prototype.csv.defaultClass;e(i,a,p)},txt:function(t,o){var n=l.prototype.txt.separator,r=[].slice.call(d).map(function(t,e){if(!~y.indexOf(e-g)&&!s(t,m)){var o=t.querySelectorAll("th, td");return[].slice.call(o).map(function(t,e){if(!~x.indexOf(e)&&!s(t,m))return s(t,m)?" ":t.textContent}).join(n)}}).join(t),i=l.prototype.escapeHtml(JSON.stringify({data:r,fileName:o,mimeType:l.prototype.txt.mimeType,fileExtension:l.prototype.txt.fileExtension})),a=l.prototype.txt.buttonContent,p=l.prototype.txt.defaultClass;e(i,a,p)}};a.settings.formats.forEach(function(t){!(!n||"xls"!==t)&&(t="xlsm"),!n&&"xlsx"===t&&(t=null),t&&h[t](u,b)})});var d=document.querySelectorAll("button[data-fileblob]");return i(d,"click",function(){var t=JSON.parse(this.getAttribute("data-fileblob")),e=t.data,o=t.fileName,n=t.mimeType,r=t.fileExtension;console.log(t,e,o,n,r),l.prototype.export2file(e,n,o,r)}),a};if(l.prototype={defaults:{headings:!0,footers:!0,formats:["xls","csv","txt"],fileName:"id",bootstrap:!0,position:"bottom",ignoreRows:null,ignoreCols:null,ignoreCSS:".tableexport-ignore",emptyCSS:".tableexport-empty"},charset:"charset=utf-8",defaultFileName:"myDownload",defaultButton:"button-default",bootstrap:["btn","btn-default","btn-toolbar"],rowDel:"\r\n",entityMap:{"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47;"},xlsx:{defaultClass:"xlsx",buttonContent:"Export to xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileExtension:".xlsx"},xls:{defaultClass:"xls",buttonContent:"Export to xls",separator:"\t",mimeType:"application/vnd.ms-excel",fileExtension:".xls"},csv:{defaultClass:"csv",buttonContent:"Export to csv",separator:",",mimeType:"application/csv",fileExtension:".csv"},txt:{defaultClass:"txt",buttonContent:"Export to txt",separator:"  ",mimeType:"text/plain",fileExtension:".txt"},escapeHtml:function(t){return String(t).replace(/[&<>'\/]/g,function(t){return l.prototype.entityMap[t]})},dateNum:function(t,e){e&&(t+=1462);var o=Date.parse(t);return(o-new Date(Date.UTC(1899,11,30)))/864e5},createSheet:function(t){for(var e={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=t.length;++r)for(var i=0;i!=t[r].length;++i){o.s.r>r&&(o.s.r=r),o.s.c>i&&(o.s.c=i),o.e.r<r&&(o.e.r=r),o.e.c<i&&(o.e.c=i);var s={v:t[r][i]};if(null!=s.v){var l=n.utils.encode_cell({c:i,r:r});"number"==typeof s.v?s.t="n":"boolean"==typeof s.v?s.t="b":s.v instanceof Date?(s.t="n",s.z=n.SSF._table[14],s.v=this.dateNum(s.v)):s.t="s",e[l]=s}}return o.s.c<1e7&&(e["!ref"]=n.utils.encode_range(o)),e},Workbook:function(){this.SheetNames=[],this.Sheets={}},string2ArrayBuffer:function(t){for(var e=new ArrayBuffer(t.length),o=new Uint8Array(e),n=0;n!=t.length;++n)o[n]=255&t.charCodeAt(n);return e},export2file:function(t,e,r,i){if(n&&".xls"==i.substr(0,4)){var s=new this.Workbook,l=this.createSheet(t);s.SheetNames.push(r),s.Sheets[r]=l;var a={bookType:i.substr(1,3)+(i.substr(4)||"m"),bookSST:!1,type:"binary"},p=n.write(s,a);t=this.string2ArrayBuffer(p)}o(new Blob([t],{type:e+";"+this.charset}),r+i)},update:function(t){return new l(this.selectors,r({},this.settings,t),(!0))},reset:function(){return new l(this.selectors,settings,(!0))},remove:function(){this.selectors.each(function(){var t=this.querySelectorAll("caption:not(.head)");t.parentNode.removeChild(t)})}},e){e.fn.tableExport=function(t,e){return new l(this,t,e)};for(var a in l.prototype)e.fn.tableExport[a]=l.prototype[a]}t["default"]=t.TableExport=l});